
[include mainsail.cfg]
[include macros.cfg]
[exclude_object]
[include KAMP_Settings.cfg]
[include Adaptive_Meshing.cfg]
[include timelapse.cfg]
[include stealthburner_leds.cfg]
#[include Demon_BTT_Eddy_Offset.cfg]

[temperature_sensor mcu_temp]
sensor_type: temperature_mcu
sensor_mcu: mcu
min_temp: 0
max_temp: 100

[temperature_sensor raspberry_pi_4b]
sensor_type: temperature_host
min_temp: 10
max_temp: 100

[mcu EBBCan]
serial: /dev/ttyACM2

[mcu]
serial: /dev/ttyACM1

[adxl345]
cs_pin: EBBCan: PB12
spi_software_sclk_pin: EBBCan: PB10
spi_software_mosi_pin: EBBCan: PB11
spi_software_miso_pin: EBBCan: PB2
axes_map: x,y,z

[resonance_tester]
accel_chip: adxl345
probe_points:
    109,102,20  # an example for a 350mm printer

[stepper_x]
step_pin: gpio11
dir_pin: !gpio10
enable_pin: !gpio12
microsteps: 16
rotation_distance: 40
endstop_pin: ^gpio4
endstop_pin: tmc2209_stepper_x:virtual_endstop
homing_retract_dist: 0
position_endstop: 0
position_max: 230
homing_speed: 20

[tmc2209 stepper_x]
uart_pin: gpio9
tx_pin: gpio8
uart_address: 0
run_current: 1.2
hold_current: 0.6
stealthchop_threshold: 999999
diag_pin: ^gpio4
driver_SGTHRS: 45

[stepper_y]
step_pin: gpio6
dir_pin: gpio5
enable_pin: !gpio7
microsteps: 16
rotation_distance: 40
endstop_pin: ^gpio3
endstop_pin: tmc2209_stepper_y:virtual_endstop
homing_retract_dist: 0
position_endstop: 0
position_max: 230
homing_speed: 20

[tmc2209 stepper_y]
uart_pin: gpio9
tx_pin: gpio8
uart_address: 2
run_current: 1.2
hold_current: 0.6
stealthchop_threshold: 999999
diag_pin: ^gpio3
driver_SGTHRS:47

[stepper_z]
step_pin: gpio19
dir_pin: !gpio28
enable_pin: !gpio2
microsteps: 16
rotation_distance: 8
#endstop_pin: ^gpio25
#position_endstop: 0
endstop_pin: probe:z_virtual_endstop
position_min: -10
position_max: 300
homing_speed: 20

[tmc2209 stepper_z]
uart_pin: gpio9
tx_pin: gpio8
uart_address: 1
run_current: 0.650
hold_current: 0.500
#stealthchop_threshold: 999999

[stepper_z1]
step_pin: gpio14
dir_pin: !gpio13
enable_pin: !gpio15
microsteps: 16
rotation_distance: 8

[extruder]
step_pin: EBBCan: PD0
dir_pin: !EBBCan: PD1
enable_pin: !EBBCan: PD2
microsteps: 16
rotation_distance: 4.48448
nozzle_diameter: 0.400
filament_diameter: 1.750
heater_pin: EBBCan: PB13
sensor_type: EPCOS 100K B57560G104F
sensor_pin: EBBCan: PA3
#control: pid
#pid_Kp: 21.527
#pid_Ki: 1.063
#pid_Kd: 108.982
min_temp: 0
max_temp: 280
pressure_advance: 0.02

[tmc2209 extruder]
uart_pin: EBBCan: PA15
run_current: 0.650
stealthchop_threshold: 999999

[filament_switch_sensor runout_sensor]
switch_pin: ^gpio16
pause_on_runout: True

# [filament_motion_sensor smart_sensor]
# switch_pin: ^gpio16
# detection_length: 2.5

[heater_bed]
heater_pin: gpio21
sensor_type: EPCOS 100K B57560G104F
sensor_pin: gpio26
#control: pid
#pid_Kp: 54.027
#pid_Ki: 0.770
#pid_Kd: 948.182
min_temp: 0
max_temp: 130

[fan]
pin: EBBCan: PA1

[heater_fan hotend_fan]
pin: EBBCan: PA0
heater: extruder
heater_temp: 50.0

[printer]
kinematics: corexy
max_velocity: 500
max_accel: 6000
max_z_velocity: 25
max_z_accel: 30

[input_shaper]
shaper_freq_x: 68.8
shaper_type_x: mzv
shaper_freq_y: 53.8
shaper_type_y: zv

[bltouch]
sensor_pin: ^EBBCan:PB8
control_pin: EBBCan:PB9
x_offset: 32.95
y_offset: -10.71
z_offset: 0
probe_with_touch_mode: true
stow_on_each_sample: false
sample_retract_dist:20

#[neopixel board_rgb]
#pin: 
#chain_count: 1
#color_order: GRB
#initial_RED: 0.3
#initial_GREEN: 0.3
#initial_BLUE: 0.3

[bed_mesh]
speed: 120
mesh_min: 10, 10
mesh_max: 200, 194
probe_count: 4,4
algorithm: bicubic

[safe_z_home]
home_xy_position: 109, 102
speed: 75
z_hop: 10
z_hop_speed: 5

[z_tilt]
horizontal_move_z: 10
retries: 5
retry_tolerance: 0.02
speed: 150
z_positions: 0, 122
            195, 122
points: 7, 76
        220, 76

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [extruder]
#*# control = pid
#*# pid_kp = 33.730
#*# pid_ki = 16.062
#*# pid_kd = 17.709
#*#
#*# [heater_bed]
#*# control = pid
#*# pid_kp = 67.911
#*# pid_ki = 1.115
#*# pid_kd = 1033.946
#*#
#*# [probe_eddy_current btt_eddy]
#*# reg_drive_current = 15
#*# calibrate =
#*# 	0.050000:3270014.331,0.090000:3268596.531,0.130000:3267177.551,
#*# 	0.170000:3265776.329,0.210000:3264456.845,0.250000:3263180.162,
#*# 	0.290000:3261827.238,0.330000:3260569.405,0.370000:3259304.883,
#*# 	0.410000:3258088.353,0.450000:3256878.753,0.490000:3255709.415,
#*# 	0.530000:3254600.928,0.570000:3253485.332,0.610000:3252388.868,
#*# 	0.650000:3251297.530,0.690000:3250270.389,0.730000:3249252.360,
#*# 	0.770000:3248227.411,0.810000:3247214.714,0.850000:3246251.416,
#*# 	0.890000:3245315.922,0.930000:3244360.767,0.970000:3243424.110,
#*# 	1.010000:3242540.318,1.050000:3241662.079,1.090000:3240790.994,
#*# 	1.130000:3239975.641,1.170000:3239123.188,1.210000:3238318.173,
#*# 	1.250000:3237523.262,1.290000:3236751.493,1.330000:3235978.209,
#*# 	1.370000:3235248.751,1.410000:3234507.873,1.450000:3233791.284,
#*# 	1.490000:3233075.522,1.530000:3232378.522,1.570000:3231708.702,
#*# 	1.610000:3231041.778,1.650000:3230389.934,1.690000:3229738.528,
#*# 	1.730000:3229102.194,1.770000:3228461.411,1.810000:3227862.239,
#*# 	1.850000:3227268.899,1.890000:3226683.937,1.930000:3226099.268,
#*# 	1.970000:3225518.748,2.010000:3224970.138,2.050000:3224441.448,
#*# 	2.090000:3223900.137,2.130000:3223380.523,2.170000:3222856.915,
#*# 	2.210000:3222318.463,2.250000:3221835.513,2.290000:3221344.147,
#*# 	2.330000:3220859.871,2.370000:3220386.574,2.410000:3219934.543,
#*# 	2.450000:3219470.551,2.490000:3219039.628,2.530000:3218608.223,
#*# 	2.570000:3218182.381,2.610000:3217746.319,2.650000:3217347.304,
#*# 	2.690000:3216930.326,2.730000:3216537.103,2.770000:3216207.797,
#*# 	2.810000:3215789.155,2.850000:3215391.648,2.890000:3215018.701,
#*# 	2.930000:3214672.342,2.970000:3214286.154,3.010000:3213970.211,
#*# 	3.050000:3213630.041,3.090000:3213298.188,3.130000:3212951.592,
#*# 	3.170000:3212637.915,3.210000:3212336.008,3.250000:3212020.544,
#*# 	3.290000:3211706.729,3.330000:3211398.116,3.370000:3211105.018,
#*# 	3.410000:3210791.342,3.450000:3210524.302,3.490000:3210252.473,
#*# 	3.530000:3209967.552,3.570000:3209696.502,3.610000:3209421.301,
#*# 	3.650000:3209159.761,3.690000:3208912.046,3.730000:3208670.314,
#*# 	3.770000:3208406.237,3.810000:3208162.086,3.850000:3207926.072,
#*# 	3.890000:3207702.186,3.930000:3207462.724,3.970000:3207234.814,
#*# 	4.010000:3207008.418,4.050000:3206782.021
#*#
#*# [temperature_probe btt_eddy]
#*# calibration_temp = 39.358529
#*# drift_calibration =
#*# 	3362024.918955, -3359.968337, 31.633767
#*# 	3320894.353215, -2404.336019, 22.399250
#*# 	3286581.220608, -1571.833946, 14.445337
#*# 	3262554.798981, -1037.105429, 9.396475
#*# 	3244917.060457, -667.837709, 5.946990
#*# 	3230816.226602, -363.396072, 3.031935
#*# 	3219290.327179, -107.562489, 0.602542
#*# 	3210665.065236, 75.182730, -1.141124
#*# 	3204727.647823, 179.789826, -2.113889
#*# drift_calibration_min_temp = 38.448888421582495
#*#
#*# [bed_mesh default]
#*# version = 1
#*# points =
#*# 	  0.133145, 0.138314, 0.132657, 0.135037, 0.147738, 0.157901, 0.158438, 0.164277, 0.151725, 0.148003, 0.143445, 0.144703, 0.141860, 0.134736, 0.125288, 0.114009, 0.105075, 0.092738, 0.086506, 0.069349, 0.047060, 0.027178, 0.001022, -0.026494, -0.090748
#*# 	  0.144993, 0.135948, 0.133776, 0.140598, 0.151770, 0.165826, 0.173618, 0.174863, 0.167000, 0.162798, 0.162250, 0.160116, 0.158709, 0.152519, 0.142980, 0.131336, 0.127944, 0.113432, 0.109101, 0.097300, 0.080966, 0.052692, 0.037277, 0.011618, -0.057267
#*# 	  0.160003, 0.155884, 0.152135, 0.166461, 0.177652, 0.197691, 0.199390, 0.196490, 0.190789, 0.185030, 0.185757, 0.186497, 0.187810, 0.169209, 0.165599, 0.157978, 0.152402, 0.143701, 0.132895, 0.126067, 0.110716, 0.084684, 0.064224, 0.039069, -0.013614
#*# 	  0.164641, 0.162394, 0.168971, 0.177451, 0.186781, 0.205001, 0.209879, 0.210992, 0.204516, 0.197238, 0.198673, 0.198503, 0.197408, 0.191964, 0.185007, 0.177372, 0.169450, 0.161412, 0.153435, 0.150190, 0.138333, 0.115798, 0.098356, 0.071620, 0.011414
#*# 	  0.182982, 0.182172, 0.187887, 0.195692, 0.208886, 0.225810, 0.232025, 0.223886, 0.215483, 0.221912, 0.216064, 0.215929, 0.218159, 0.213274, 0.208043, 0.204563, 0.186748, 0.184589, 0.179036, 0.176451, 0.164015, 0.144021, 0.127099, 0.105930, 0.054529
#*# 	  0.189254, 0.196960, 0.194978, 0.208225, 0.226939, 0.238271, 0.242193, 0.236507, 0.233682, 0.231559, 0.227781, 0.228808, 0.236304, 0.235950, 0.229509, 0.215992, 0.205775, 0.207629, 0.205678, 0.196451, 0.191043, 0.168750, 0.148946, 0.131333, 0.075315
#*# 	  0.208823, 0.222938, 0.227057, 0.238867, 0.250645, 0.265824, 0.269423, 0.265819, 0.261252, 0.252241, 0.254990, 0.258716, 0.263567, 0.256466, 0.254699, 0.248160, 0.241434, 0.236488, 0.228734, 0.224821, 0.216257, 0.198839, 0.177500, 0.157079, 0.107803
#*# 	  0.223994, 0.235721, 0.241253, 0.249422, 0.267240, 0.273770, 0.281643, 0.281466, 0.275231, 0.270055, 0.270378, 0.273544, 0.282444, 0.279852, 0.270784, 0.269885, 0.259872, 0.256204, 0.249517, 0.245720, 0.241314, 0.223135, 0.202303, 0.182486, 0.133197
#*# 	  0.220477, 0.242958, 0.244276, 0.258158, 0.273301, 0.290630, 0.295006, 0.290311, 0.288529, 0.280354, 0.286972, 0.288690, 0.293032, 0.291320, 0.288503, 0.285078, 0.280537, 0.274253, 0.271269, 0.267370, 0.257785, 0.237714, 0.222861, 0.204973, 0.161768
#*# 	  0.230924, 0.249530, 0.258918, 0.271853, 0.285533, 0.299820, 0.305700, 0.305444, 0.304874, 0.302284, 0.303568, 0.306035, 0.306399, 0.310113, 0.311974, 0.309494, 0.301980, 0.297834, 0.290810, 0.294504, 0.281995, 0.267168, 0.244455, 0.232044, 0.179785
#*# 	  0.232552, 0.257447, 0.261085, 0.278717, 0.297133, 0.306384, 0.317625, 0.316877, 0.315183, 0.318329, 0.320555, 0.319929, 0.320305, 0.321630, 0.319543, 0.319283, 0.310741, 0.308976, 0.309441, 0.308840, 0.298778, 0.281224, 0.264039, 0.244890, 0.212256
#*# 	  0.231694, 0.256009, 0.267337, 0.280458, 0.301564, 0.313995, 0.327541, 0.328263, 0.324279, 0.324337, 0.325858, 0.325475, 0.330025, 0.330411, 0.331876, 0.326639, 0.324852, 0.324710, 0.328364, 0.321944, 0.311978, 0.302283, 0.277412, 0.270952, 0.225529
#*# 	  0.233501, 0.267102, 0.274576, 0.291721, 0.311596, 0.322410, 0.335904, 0.337683, 0.335336, 0.332237, 0.337109, 0.338873, 0.341380, 0.340200, 0.335229, 0.338173, 0.339101, 0.336939, 0.334868, 0.336621, 0.327918, 0.313869, 0.295861, 0.283491, 0.248951
#*# 	  0.239910, 0.265670, 0.276345, 0.291851, 0.312642, 0.324735, 0.337150, 0.340192, 0.338094, 0.336387, 0.339803, 0.343286, 0.348915, 0.346414, 0.345337, 0.341545, 0.342107, 0.344571, 0.346659, 0.346132, 0.338301, 0.331075, 0.307856, 0.296674, 0.254362
#*# 	  0.226692, 0.265573, 0.274711, 0.291203, 0.312759, 0.328355, 0.335348, 0.338325, 0.335107, 0.335965, 0.339283, 0.348224, 0.347386, 0.350677, 0.347703, 0.343833, 0.349819, 0.346203, 0.350203, 0.350945, 0.350435, 0.341382, 0.320336, 0.309927, 0.281165
#*# 	  0.239727, 0.266179, 0.275053, 0.292767, 0.314950, 0.326913, 0.337178, 0.340009, 0.339947, 0.337674, 0.338287, 0.348031, 0.353990, 0.352273, 0.351854, 0.352806, 0.352738, 0.349199, 0.350318, 0.355569, 0.352029, 0.347537, 0.328292, 0.323413, 0.281725
#*# 	  0.229653, 0.273784, 0.276823, 0.298605, 0.313863, 0.330415, 0.338065, 0.339276, 0.343194, 0.342538, 0.346906, 0.350830, 0.352409, 0.355711, 0.352362, 0.354350, 0.356638, 0.356622, 0.356262, 0.359940, 0.356057, 0.351392, 0.340493, 0.327113, 0.301932
#*# 	  0.240086, 0.265912, 0.279093, 0.295484, 0.315080, 0.330080, 0.332671, 0.339186, 0.340831, 0.344229, 0.346826, 0.349958, 0.353406, 0.359275, 0.360097, 0.356906, 0.360288, 0.355246, 0.361046, 0.362673, 0.359378, 0.360198, 0.339766, 0.340403, 0.302002
#*# 	  0.235842, 0.272325, 0.280351, 0.298628, 0.312339, 0.332073, 0.342205, 0.342139, 0.349863, 0.346381, 0.349845, 0.357540, 0.359485, 0.359322, 0.361471, 0.358879, 0.362660, 0.362182, 0.362271, 0.363694, 0.364747, 0.363718, 0.354988, 0.348793, 0.327857
#*# 	  0.239147, 0.261165, 0.271562, 0.292503, 0.310883, 0.323868, 0.341436, 0.344735, 0.342271, 0.340621, 0.347279, 0.351772, 0.355945, 0.357005, 0.355737, 0.360227, 0.360646, 0.354579, 0.360397, 0.366088, 0.361899, 0.369678, 0.355130, 0.358625, 0.321423
#*# 	  0.203042, 0.246579, 0.252758, 0.276609, 0.292527, 0.310042, 0.328529, 0.331501, 0.338595, 0.337524, 0.341511, 0.342670, 0.345862, 0.350673, 0.348902, 0.353063, 0.352688, 0.355091, 0.356877, 0.362634, 0.366933, 0.368930, 0.361943, 0.358430, 0.344387
#*# 	  0.202078, 0.233109, 0.243917, 0.263089, 0.280296, 0.299807, 0.320929, 0.327405, 0.334112, 0.333316, 0.336878, 0.346808, 0.341714, 0.346867, 0.347330, 0.348176, 0.348164, 0.348428, 0.360787, 0.364345, 0.364597, 0.373769, 0.362610, 0.366525, 0.339640
#*# 	  0.182574, 0.232497, 0.231580, 0.253822, 0.273570, 0.293149, 0.316132, 0.320241, 0.331701, 0.332454, 0.336890, 0.339987, 0.347272, 0.353218, 0.346830, 0.348984, 0.351195, 0.353597, 0.361819, 0.369093, 0.370859, 0.373136, 0.377627, 0.376781, 0.368025
#*# 	  0.182971, 0.218065, 0.219794, 0.241068, 0.260240, 0.280375, 0.299502, 0.313820, 0.321228, 0.323565, 0.327567, 0.335919, 0.336930, 0.342147, 0.343403, 0.336603, 0.343913, 0.347577, 0.362996, 0.368611, 0.373384, 0.384036, 0.371423, 0.383942, 0.360815
#*# 	  0.165883, 0.211359, 0.211014, 0.228707, 0.249873, 0.267626, 0.291832, 0.298703, 0.314132, 0.317907, 0.324572, 0.328740, 0.333517, 0.340516, 0.340641, 0.342793, 0.341111, 0.347681, 0.364778, 0.376718, 0.383797, 0.389423, 0.387278, 0.392677, 0.388906
#*# x_count = 25
#*# y_count = 25
#*# mesh_x_pps = 2
#*# mesh_y_pps = 2
#*# algo = bicubic
#*# tension = 0.2
#*# min_x = 10.0
#*# max_x = 220.0
#*# min_y = 30.0
#*# max_y = 199.9200000000001
